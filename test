
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Decision Game</title>
    <style>
        body { font-family: Arial, sans-serif; text-align: center; }
        #leaderboard { margin-top: 20px; }
        .hidden { display: none; }
    </style>
</head>
<body>
    <h1>Decision Game</h1>
    <button onclick="startGame()">Start Game</button>
    <button onclick="toggleLeaderboard()">Toggle Leaderboard</button>
    <div id="leaderboard" class="hidden"></div>

</body>
<script>
let leaderboardVisible = false;
let currentMode = 'normal'; // or 'blind'

function startGame() {
    console.log("Game started");
    // Placeholder for game logic
}

// Function triggered when toggling leaderboard view
function toggleLeaderboard() {
    leaderboardVisible = !leaderboardVisible;
    const leaderboardDiv = document.getElementById('leaderboard');
    if (leaderboardVisible) {
        leaderboardDiv.classList.remove('hidden');
        fetchWixAndRenderLeaderboard(currentMode);
    } else {
        leaderboardDiv.classList.add('hidden');
    }
}

// Fetch from Wix and populate localStorage and then render
async function fetchWixAndRenderLeaderboard(mode) {
    try {
        const response = await fetch("https://www.peopleoftheworld.net/_functions/getLeaderboard");
        if (!response.ok) throw new Error("Fetch failed");

        const data = await response.json();
        const stats = data.items || [];

        localStorage.setItem(`leaderboard_${mode}`, JSON.stringify(stats));
        console.log("Wix data loaded into local storage");

        renderLeaderboard(stats);
    } catch (error) {
        console.error("Wix fetch failed, using localStorage if available.", error);
        const fallback = JSON.parse(localStorage.getItem(`leaderboard_${mode}`) || "[]");
        renderLeaderboard(fallback);
    }
}

// Display stats on page
function renderLeaderboard(stats) {
    const div = document.getElementById('leaderboard');
    div.innerHTML = "<h2>Leaderboard</h2><ol>" + stats.map(entry =>
        `<li>${entry.initials || '---'} - ${entry.time || '--'}s</li>`).join('') + "</ol>";
}
</script>
</html>

